<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" type="image/png" href="../assets/logo.jpg" />
    <title>Qu·∫£n Tr·ªã - Volunteer Match</title>
    <link rel="stylesheet" href="../css/admin.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <script src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
  </head>
  <body>
    <div class="admin-container">
      <!-- Sidebar Navigation -->
      <div class="admin-sidebar">
        <div class="logo-container">
          <a href="../header.html" class="logo-nav">
            <img src="../assets/logo.jpg" alt="Logo" />
            <span>Volunteer Match</span>
          </a>
        </div>
        <nav class="admin-nav">
          <ul>
            <li class="active" data-tab="dashboard">
              <i class="fas fa-tachometer-alt"></i> T·ªïng quan
            </li>
            <li data-tab="users">
              <i class="fas fa-users"></i> Qu·∫£n l√Ω ng∆∞·ªùi d√πng
            </li>
            <li data-tab="posts">
              <i class="fas fa-newspaper"></i> Qu·∫£n l√Ω b√†i ƒëƒÉng
            </li>
            <li data-tab="customer-chat">
              <i class="fas fa-comments"></i> T∆∞ v·∫•n kh√°ch h√†ng
            </li>
            <li data-tab="tours"><i class="fas fa-plane"></i> Qu·∫£n l√Ω Tour</li>
            <li data-tab="settings"><i class="fas fa-cog"></i> C√†i ƒë·∫∑t</li>
          </ul>
        </nav>
        <div class="admin-logout">
          <button id="logout-btn">
            <i class="fas fa-sign-out-alt"></i> ƒêƒÉng xu·∫•t
          </button>
        </div>
      </div>

      <!-- Main Content Area -->
      <div class="admin-content">
        <!-- Header -->
        <div class="admin-header">
          <div class="admin-search">
            <input type="text" placeholder="T√¨m ki·∫øm..." />
            <button><i class="fas fa-search"></i></button>
          </div>
          <div class="admin-user">
            <span id="admin-name">Admin</span>
            <img src="../assets/logo.jpg" alt="Admin" class="admin-avatar" />
          </div>
        </div>

        <!-- Dashboard Tab -->
        <div class="admin-tab active" id="dashboard-tab">
          <h2>T·ªïng quan h·ªá th·ªëng</h2>
          <div class="dashboard-stats">
            <div class="stat-card">
              <div class="stat-icon users">
                <i class="fas fa-users"></i>
              </div>
              <div class="stat-info">
                <h3>Ng∆∞·ªùi d√πng</h3>
                <p id="user-count">0</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon posts">
                <i class="fas fa-newspaper"></i>
              </div>
              <div class="stat-info">
                <h3>B√†i ƒëƒÉng</h3>
                <p id="post-count">0</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon pending">
                <i class="fas fa-clock"></i>
              </div>
              <div class="stat-info">
                <h3>Ch·ªù duy·ªát</h3>
                <p id="pending-count">0</p>
              </div>
            </div>
          </div>
          <div class="recent-activity">
            <h3>Ho·∫°t ƒë·ªông g·∫ßn ƒë√¢y</h3>
            <div class="activity-list" id="activity-list">
              <!-- Activity items will be added dynamically -->
              <p class="empty-message">Ch∆∞a c√≥ ho·∫°t ƒë·ªông n√†o.</p>
            </div>
          </div>
        </div>

        <!-- Users Tab -->
        <div class="admin-tab" id="users-tab">
          <div class="tab-header">
            <h2>Qu·∫£n l√Ω ng∆∞·ªùi d√πng</h2>
            <button class="add-btn" id="add-user-btn">
              <i class="fas fa-plus"></i> Th√™m ng∆∞·ªùi d√πng
            </button>
          </div>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>H·ªç t√™n</th>
                  <th>Email</th>
                  <th>Ng√†y t·∫°o</th>
                  <th>Tr·∫°ng th√°i</th>
                  <th>Vai tr√≤</th>
                  <th>Thao t√°c</th>
                </tr>
              </thead>
              <tbody id="users-table-body">
                <!-- User rows will be added dynamically -->
              </tbody>
            </table>
            <div class="pagination" id="users-pagination">
              <!-- Pagination will be added dynamically -->
            </div>
          </div>
        </div>

        <!-- Posts Tab -->
        <div class="admin-tab" id="posts-tab">
          <div class="tab-header">
            <h2>Qu·∫£n l√Ω b√†i ƒëƒÉng</h2>
            <div class="filter-container">
              <select id="post-status-filter">
                <option value="all">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                <option value="pending">Ch·ªù duy·ªát</option>
                <option value="approved">ƒê√£ duy·ªát</option>
                <option value="rejected">T·ª´ ch·ªëi</option>
              </select>
            </div>
          </div>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>Ti√™u ƒë·ªÅ</th>
                  <th>Ng∆∞·ªùi ƒëƒÉng</th>
                  <th>Ng√†y ƒëƒÉng</th>
                  <th>Tr·∫°ng th√°i</th>
                  <th>Thao t√°c</th>
                </tr>
              </thead>
              <tbody id="posts-table-body">
                <!-- Post rows will be added dynamically -->
                <tr>
                  <td colspan="6" class="empty-message">
                    Ch∆∞a c√≥ b√†i ƒëƒÉng n√†o.
                  </td>
                </tr>
              </tbody>
            </table>
            <div class="pagination" id="posts-pagination">
              <!-- Pagination will be added dynamically -->
            </div>
          </div>
        </div>

        <!-- Customer Chat / Consultation Tab -->
        <div class="admin-tab" id="customer-chat-tab">
          <h2>T∆∞ v·∫•n kh√°ch h√†ng</h2>
          <div class="chat-admin-controls">
            <button id="toggleOnlineBtnChat" class="admin-chat-btn">
              <i class="fas fa-power-off"></i> <span>B·∫≠t Online</span>
            </button>
            <div id="statusTextChat">Tr·∫°ng th√°i: Offline</div>
            <div id="statusDotChat" class="status-dot-chat"></div>
          </div>

          <div class="admin-chat-layout">
            <div class="chat-session-list-container">
              <h3>Danh s√°ch tr√≤ chuy·ªán</h3>
              <div id="chat-session-list">
                <!-- Danh s√°ch c√°c phi√™n chat s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y b·ªüi admin.js -->
                <!-- V√≠ d·ª• m·ªôt item:
                <div class="chat-session-item" data-customer-id="123">
                    <div class="session-customer-name">T√™n Kh√°ch H√†ng (email@example.com)</div>
                    <div class="session-last-message">N·ªôi dung tin nh·∫Øn cu·ªëi...</div>
                    <span class="unread-badge">2</span>
                </div>
                -->
              </div>
            </div>
            <div class="chat-messages-area">
              <h3>N·ªôi dung tr√≤ chuy·ªán</h3>
              <div id="chat-messages-container">
                <!-- Tin nh·∫Øn c·ªßa kh√°ch h√†ng ƒë∆∞·ª£c ch·ªçn s·∫Ω hi·ªÉn th·ªã ·ªü ƒë√¢y -->
                <div class="no-messages-admin">
                  üí¨ Ch·ªçn m·ªôt kh√°ch h√†ng ƒë·ªÉ xem tin nh·∫Øn ho·∫∑c b·∫≠t online ƒë·ªÉ nh·∫≠n
                  tin nh·∫Øn m·ªõi.
                </div>
              </div>
              <div class="admin-reply-area">
                <textarea
                  id="replyTextAdmin"
                  placeholder="Nh·∫≠p tin nh·∫Øn tr·∫£ l·ªùi..."
                ></textarea>
                <button id="sendReplyBtnAdmin" class="admin-chat-btn send-btn">
                  <i class="fas fa-paper-plane"></i> G·ª≠i
                </button>
              </div>
            </div>
          </div>
        </div>
        <!-- Tour Management Tab -->
        <div class="admin-tab" id="tours-tab">
          <div class="tab-header">
            <h2>Qu·∫£n l√Ω ƒêƒÉng k√Ω Tour</h2>
            <div class="filter-container">
              <select id="tour-filter" class="tour-filter">
                <option value="">T·∫•t c·∫£ c√°c tour</option>
                <option value="can-gio">Can Gio Tour</option>
                <option value="daknong">Dak Nong Tour</option>
                <option value="mai-chau">Mai Chau Tour</option>
                <option value="ta-van">Ta Van Tour</option>
                <option value="tay-nguyen">Tay Nguyen Tour</option>
                <option value="van-ho">Van Ho Tour</option>
              </select>
              <button id="export-excel-btn" class="export-btn">
                <i class="fas fa-file-excel"></i> Xu·∫•t Excel
              </button>
            </div>
          </div>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>ID</th>
                  <th>M√£ Tour</th>
                  <th>T√™n kh√°ch h√†ng</th>
                  <th>Ng√†y sinh</th>
                  <th>S·ªë ƒëi·ªán tho·∫°i</th>
                  <th>CMND/CCCD</th>
                  <th>Email</th>
                  <th>T√™n Tour</th>
                  <th>Ng√†y kh·ªüi h√†nh</th>
                  <th>Ng√†y ƒëƒÉng k√Ω</th>
                  <th>Gi·ªù ƒëƒÉng k√Ω</th>
                </tr>
              </thead>
              <tbody id="tours-table-body">
                <!-- Tour registration rows will be added dynamically -->
              </tbody>
            </table>
          </div>
        </div>

        <!-- Settings Tab -->
        <div class="admin-tab" id="settings-tab">
          <h2>C√†i ƒë·∫∑t h·ªá th·ªëng</h2>
          <div class="settings-container">
            <div class="settings-card">
              <h3>Th√¥ng tin t√†i kho·∫£n</h3>
              <form id="admin-profile-form">
                <div class="form-group">
                  <label for="admin-profile-name">H·ªç t√™n</label>
                  <input type="text" id="admin-profile-name" name="name" />
                </div>
                <div class="form-group">
                  <label for="admin-profile-email">Email</label>
                  <input
                    type="email"
                    id="admin-profile-email"
                    name="email"
                    readonly
                  />
                </div>
                <div class="form-group">
                  <label for="admin-profile-password">M·∫≠t kh·∫©u m·ªõi</label>
                  <input
                    type="password"
                    id="admin-profile-password"
                    name="password"
                    placeholder="ƒê·ªÉ tr·ªëng n·∫øu kh√¥ng thay ƒë·ªïi"
                  />
                </div>
                <div class="form-group">
                  <label for="admin-profile-confirm-password"
                    >X√°c nh·∫≠n m·∫≠t kh·∫©u</label
                  >
                  <input
                    type="password"
                    id="admin-profile-confirm-password"
                    name="confirmPassword"
                  />
                </div>
                <button type="submit" class="save-btn">
                  <i class="fas fa-save"></i> L∆∞u thay ƒë·ªïi
                </button>
              </form>
            </div>
            <div class="settings-card">
              <h3>C√†i ƒë·∫∑t h·ªá th·ªëng</h3>
              <form id="system-settings-form">
                <div class="form-group">
                  <label for="items-per-page">S·ªë m·ª•c hi·ªÉn th·ªã m·ªói trang</label>
                  <input
                    type="number"
                    id="items-per-page"
                    name="itemsPerPage"
                    min="5"
                    max="50"
                    value="10"
                  />
                </div>
                <div class="form-group">
                  <label for="auto-approve-posts">T·ª± ƒë·ªông duy·ªát b√†i ƒëƒÉng</label>
                  <div class="toggle-switch">
                    <input
                      type="checkbox"
                      id="auto-approve-posts"
                      name="autoApprovePosts"
                    />
                    <label for="auto-approve-posts"></label>
                  </div>
                </div>
                <button type="submit" class="save-btn">
                  <i class="fas fa-save"></i> L∆∞u c√†i ƒë·∫∑t
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modals -->
    <!-- Add/Edit User Modal -->
    <div class="modal" id="user-modal">
      <div class="modal-content">
        <div class="modal-header">
          <h3 id="user-modal-title">Th√™m ng∆∞·ªùi d√πng m·ªõi</h3>
          <button class="close-btn" id="close-user-modal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="user-form">
            <input type="hidden" id="user-id" name="id" />
            <div class="form-group">
              <label for="user-name">H·ªç t√™n *</label>
              <input type="text" id="user-name" name="name" required />
            </div>
            <div class="form-group">
              <label for="user-email">Email *</label>
              <input type="email" id="user-email" name="email" required />
            </div>
            <div class="form-group">
              <label for="user-password">M·∫≠t kh·∫©u *</label>
              <input type="password" id="user-password" name="password" />
              <small>ƒê·ªÉ tr·ªëng n·∫øu kh√¥ng thay ƒë·ªïi (khi ch·ªânh s·ª≠a)</small>
            </div>
            <div class="form-group">
              <label for="user-status">Tr·∫°ng th√°i</label>
              <select id="user-status" name="status">
                <option value="active">Ho·∫°t ƒë·ªông</option>
                <option value="inactive">Kh√¥ng ho·∫°t ƒë·ªông</option>
              </select>
            </div>
            <div class="form-group">
              <label for="user-role">Vai tr√≤</label>
              <select id="user-role" name="role">
                <option value="user">Ng∆∞·ªùi d√πng</option>
                <option value="admin">Qu·∫£n tr·ªã vi√™n</option>
              </select>
            </div>
            <div class="form-actions">
              <button type="button" class="cancel-btn" id="cancel-user-form">
                H·ªßy b·ªè
              </button>
              <button type="submit" class="save-btn">
                <i class="fas fa-save"></i> L∆∞u
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- View Post Modal -->
    <div class="modal" id="post-modal">
      <div class="modal-content large-modal">
        <div class="modal-header">
          <h3 id="post-modal-title">Chi ti·∫øt b√†i ƒëƒÉng</h3>
          <button class="close-btn" id="close-post-modal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <div class="post-details">
            <div class="post-info">
              <h4 id="post-title"></h4>
              <div class="post-meta">
                <span id="post-author"></span> |
                <span id="post-date"></span>
              </div>
            </div>
            <div class="post-content" id="post-content"></div>
          </div>
          <div class="post-actions">
            <button class="reject-btn" id="reject-post-btn">
              <i class="fas fa-times"></i> T·ª´ ch·ªëi
            </button>
            <button class="approve-btn" id="approve-post-btn">
              <i class="fas fa-check"></i> Duy·ªát b√†i
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Confirmation Modal -->
    <div class="modal" id="confirm-modal">
      <div class="modal-content small-modal">
        <div class="modal-header">
          <h3 id="confirm-modal-title">X√°c nh·∫≠n</h3>
          <button class="close-btn" id="close-confirm-modal">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <p id="confirm-modal-message">
            B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën th·ª±c hi·ªán h√†nh ƒë·ªông n√†y?
          </p>
          <div class="form-actions">
            <button type="button" class="cancel-btn" id="cancel-confirm">
              H·ªßy b·ªè
            </button>
            <button type="button" class="confirm-btn" id="confirm-action">
              X√°c nh·∫≠n
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- JavaScript -->
    <script src="../js/admin.js"></script>
  </body>
</html>
